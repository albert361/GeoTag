<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>GeoTag Picture Location Map</title>
<script type="text/javascript"
    src="http://maps.google.com/maps/api/js"></script>
<script type="text/javascript">
    var map
    var loc

    function initialize() {
        loc = new google.maps.LatLng(controller.mapLatitude,
                                     controller.mapLongitude);
        var mapOptions = {
            zoom: controller.mapZoom,
            center: loc,
            mapTypeId: segmentToMapTypeId(controller.mapType),
            mapTypeControl: false
        };
        map = new google.maps.Map(document.getElementById("map_canvas"),
                                  mapOptions);

        google.maps.event.addListener(map, 'center_changed', function() {
            var position = map.getCenter();
            controller.mapLatitude = position.lat();
            controller.mapLongitude = position.lng();
        });

        google.maps.event.addListener(map, 'zoom_changed', function() {
            controller.mapZoom = map.getZoom();
        });
    }

    /*
        Map type is selected by the user using a segmented control.
        This function converts a segment number to a MapTypeId
    */
    function segmentToMapTypeId(segmentNumber) {
        switch (segmentNumber) {
        case 1:
            return google.maps.MapTypeId.HYBRID;
        case 2:
            return google.maps.MapTypeId.SATELLITE;
        }
        // assume ROADMAP
        return google.maps.MapTypeId.ROADMAP;
    }

    function setMapTypeId(segmentNumber) {
        controller.mapType = segmentNumber
        map.setMapTypeId(segmentToMapTypeId(segmentNumber));
    }

    function setMapLocation(latitude, longitude) {
        loc = new google.maps.LatLng(latitude, longitude);
        map.setCenter(loc);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>
<body style="margin:0px; padding:0px;">
<div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html>